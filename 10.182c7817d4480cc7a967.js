(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"g+f/":function(t,e,o){"use strict";o.r(e),o.d(e,"PurchasesModule",(function(){return Vt}));var c=o("ofXK"),i=o("3Pt+"),a=o("OLFy"),r=o("tyNb"),n=o("M9IT"),b=o("2Vo4"),l=o("LRne"),s=o("JIr8"),u=o("nYR2");class d{constructor(t){this.purchaseService=t,this.productSubject=new b.a([]),this.loadingSubject=new b.a(!1),this.loading$=this.loadingSubject.asObservable()}connect(t){return this.productSubject.asObservable()}disconnect(t){this.productSubject.complete(),this.loadingSubject.complete()}loadSales(){this.loadingSubject.next(!0),this.purchaseService.getAll().pipe(Object(s.a)(()=>Object(l.a)([])),Object(u.a)(()=>this.loadingSubject.next(!1))).subscribe(t=>{this.productSubject.next(t)})}}var m=o("fXoL"),p=o("85ZM"),f=o("/t3+"),h=o("XiUz"),S=o("bTqV"),g=o("NFeN"),T=o("znSr"),y=o("+0xr");function v(t,e){1&t&&(m.Tb(0,"th",17),m.zc(1,"id"),m.Sb())}function C(t,e){if(1&t&&(m.Tb(0,"td",18),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.idCompra)}}function B(t,e){1&t&&(m.Tb(0,"th",17),m.zc(1,"Precio total"),m.Sb())}function z(t,e){if(1&t&&(m.Tb(0,"td",18),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.preciototal)}}function w(t,e){1&t&&(m.Tb(0,"th",17),m.zc(1,"Distribuidor"),m.Sb())}function O(t,e){if(1&t&&(m.Tb(0,"td",18),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.distribuidor)}}function k(t,e){1&t&&(m.Tb(0,"th",17),m.zc(1,"Fecha"),m.Sb())}function P(t,e){if(1&t&&(m.Tb(0,"td",18),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Bc(" ",t.fecha," ")}}function x(t,e){1&t&&m.Ob(0,"th",17)}function D(t,e){if(1&t&&(m.Tb(0,"td",19),m.Tb(1,"a",20),m.Tb(2,"mat-icon",21),m.zc(3,"visibility"),m.Sb(),m.Sb(),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.mc("routerLink","detalle/",t.idCompra,"")}}function R(t,e){1&t&&m.Ob(0,"th",17)}function L(t,e){if(1&t){const t=m.Ub();m.Tb(0,"td",19),m.Tb(1,"a",22),m.bc("click",(function(o){m.rc(t);const c=e.$implicit;return m.fc().deleteProduct(o,c.idCompra)})),m.Tb(2,"mat-icon",21),m.zc(3,"backspace"),m.Sb(),m.Sb(),m.Sb()}}function A(t,e){1&t&&m.Ob(0,"tr",23)}function N(t,e){1&t&&m.Ob(0,"tr",24)}const $=function(){return[5,10,20]};let F=(()=>{class t{constructor(t){this.purchaseService=t,this.displayedColumns=["idCompra","preciototal","distribuidor","fecha","view","delete"]}ngOnInit(){this.dataSource=new d(this.purchaseService),this.dataSource.loadSales()}deleteProduct(t,e){this.purchaseService.delete(e).subscribe(t=>{this.dataSource.loadSales()},t=>{console.log(t)})}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(p.a))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-purchases"]],viewQuery:function(t,e){var o;1&t&&m.vc(n.a,!0),2&t&&m.oc(o=m.cc())&&(e.paginator=o.first)},decls:34,vars:5,consts:[["fxLayout","row","fxLayoutAlign","space-between center"],["routerLink","comprar","mat-raised-button","","color","primary"],["fxLayout","column"],["fxLayout","column","ngClass.xs","scrollable",1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","idCompra","fxFlex","auto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","preciototal"],["matColumnDef","distribuidor"],["matColumnDef","fecha"],["matColumnDef","view"],["mat-cell","","class","action-link",4,"matCellDef"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"action-link"],[3,"routerLink"],["aria-hidden","false","aria-label","Example home icon"],["routerLink","./",1,"a-warning",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(m.Tb(0,"mat-toolbar",0),m.Tb(1,"div"),m.Tb(2,"span"),m.zc(3,"Compras"),m.Sb(),m.Sb(),m.Tb(4,"div"),m.Tb(5,"button",1),m.Tb(6,"mat-icon"),m.zc(7,"person"),m.Sb(),m.zc(8," Realizar Compra "),m.Sb(),m.Sb(),m.Sb(),m.Tb(9,"section",2),m.Tb(10,"div",2),m.Tb(11,"div",3),m.Tb(12,"table",4),m.Rb(13,5),m.yc(14,v,2,0,"th",6),m.yc(15,C,2,1,"td",7),m.Qb(),m.Rb(16,8),m.yc(17,B,2,0,"th",6),m.yc(18,z,2,1,"td",7),m.Qb(),m.Rb(19,9),m.yc(20,w,2,0,"th",6),m.yc(21,O,2,1,"td",7),m.Qb(),m.Rb(22,10),m.yc(23,k,2,0,"th",6),m.yc(24,P,2,1,"td",7),m.Qb(),m.Rb(25,11),m.yc(26,x,1,0,"th",6),m.yc(27,D,4,1,"td",12),m.Qb(),m.Rb(28,13),m.yc(29,R,1,0,"th",6),m.yc(30,L,4,0,"td",12),m.Qb(),m.yc(31,A,1,0,"tr",14),m.yc(32,N,1,0,"tr",15),m.Sb(),m.Ob(33,"mat-paginator",16),m.Sb(),m.Sb(),m.Sb()),2&t&&(m.Bb(12),m.lc("dataSource",e.dataSource),m.Bb(19),m.lc("matHeaderRowDef",e.displayedColumns),m.Bb(1),m.lc("matRowDefColumns",e.displayedColumns),m.Bb(1),m.lc("pageSizeOptions",m.nc(4,$)))},directives:[f.a,h.e,h.d,S.b,r.d,g.a,T.a,y.j,y.c,h.b,y.e,y.b,y.g,y.i,n.a,y.d,y.a,r.f,y.f,y.h],styles:["table[_ngcontent-%COMP%]{width:100%}.scrollable[_ngcontent-%COMP%]{overflow-x:scroll}.a-warning[_ngcontent-%COMP%]{color:red}"]}),t})();function I(t,e){1&t&&(m.Tb(0,"th",20),m.zc(1,"id"),m.Sb())}function Q(t,e){if(1&t&&(m.Tb(0,"td",21),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.idProducto)}}function j(t,e){1&t&&(m.Tb(0,"th",20),m.zc(1,"Nombre"),m.Sb())}function _(t,e){if(1&t&&(m.Tb(0,"td",21),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.nombre)}}function q(t,e){1&t&&(m.Tb(0,"th",20),m.zc(1,"Precio"),m.Sb())}function M(t,e){if(1&t&&(m.Tb(0,"td",21),m.zc(1),m.gc(2,"currency"),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Bc(" ",m.ic(2,1,t.preciounitario,"CLP","$")," ")}}function V(t,e){1&t&&(m.Tb(0,"th",20),m.zc(1,"Codigo de Barra"),m.Sb())}function E(t,e){if(1&t&&(m.Tb(0,"td",21),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Bc(" ",t.codigodebarra," ")}}function U(t,e){1&t&&(m.Tb(0,"th",20),m.zc(1,"Cantidad"),m.Sb())}function H(t,e){if(1&t&&(m.Tb(0,"td",21),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Bc(" ",t.cantidad," ")}}function G(t,e){1&t&&(m.Tb(0,"th",20),m.zc(1,"Categoria"),m.Sb())}function X(t,e){if(1&t&&(m.Tb(0,"td",21),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.categoria)}}function K(t,e){1&t&&(m.Tb(0,"th",20),m.zc(1,"Precio Total"),m.Sb())}function J(t,e){if(1&t&&(m.Tb(0,"td",21),m.zc(1),m.gc(2,"currency"),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Bc(" ",m.ic(2,1,t.preciototal,"CLP","$")," ")}}function W(t,e){1&t&&m.Ob(0,"tr",22)}function Y(t,e){1&t&&m.Ob(0,"tr",23)}const Z=function(){return[5,10,20]};let tt=(()=>{class t{constructor(t,e){this.activatedRoute=t,this.purchaseService=e,this.displayedColumns=["id","nombre","preciounitario","codigodebarra","cantidad","categoria","preciototal"],this.compra={}}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.id=t.id,this.purchaseService.get(this.id).subscribe(t=>{this.dataSource=new y.k(t.detalle_compra),this.dataSource.paginator=this.paginator,this.compra=t.compra},t=>{console.log(t)})})}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(r.a),m.Nb(p.a))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-purchase-detail"]],viewQuery:function(t,e){var o;1&t&&m.vc(n.a,!0),2&t&&m.oc(o=m.cc())&&(e.paginator=o.first)},decls:49,vars:10,consts:[["fxLayout","row","fxLayoutAlign","space-between center"],["fxLayout","row"],["routerLink","../../","mat-icon-button","","color","primary"],["fxFlexAlign","center"],["fxLayout","column"],["fxLayout","column","fxFlex","90%"],["fxLayout","column","ngClass.xs","scrollable",1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","id","fxFlex","auto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","preciounitario"],["matColumnDef","codigodebarra"],["matColumnDef","cantidad"],["matColumnDef","categoria"],["matColumnDef","preciototal"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(m.Tb(0,"mat-toolbar",0),m.Tb(1,"div",1),m.Tb(2,"a",2),m.Tb(3,"mat-icon"),m.zc(4,"arrow_back"),m.Sb(),m.Sb(),m.Tb(5,"span",3),m.zc(6),m.Sb(),m.Sb(),m.Ob(7,"div"),m.Sb(),m.Tb(8,"section",4),m.Tb(9,"div",4),m.Tb(10,"div",5),m.Tb(11,"div"),m.Tb(12,"span"),m.zc(13),m.Sb(),m.Sb(),m.Tb(14,"div"),m.Tb(15,"span"),m.zc(16),m.Sb(),m.Sb(),m.Tb(17,"div"),m.Tb(18,"span"),m.zc(19),m.Sb(),m.Sb(),m.Tb(20,"div"),m.Tb(21,"span"),m.zc(22),m.Sb(),m.Sb(),m.Sb(),m.Tb(23,"div",6),m.Tb(24,"table",7),m.Rb(25,8),m.yc(26,I,2,0,"th",9),m.yc(27,Q,2,1,"td",10),m.Qb(),m.Rb(28,11),m.yc(29,j,2,0,"th",9),m.yc(30,_,2,1,"td",10),m.Qb(),m.Rb(31,12),m.yc(32,q,2,0,"th",9),m.yc(33,M,3,5,"td",10),m.Qb(),m.Rb(34,13),m.yc(35,V,2,0,"th",9),m.yc(36,E,2,1,"td",10),m.Qb(),m.Rb(37,14),m.yc(38,U,2,0,"th",9),m.yc(39,H,2,1,"td",10),m.Qb(),m.Rb(40,15),m.yc(41,G,2,0,"th",9),m.yc(42,X,2,1,"td",10),m.Qb(),m.Rb(43,16),m.yc(44,K,2,0,"th",9),m.yc(45,J,3,5,"td",10),m.Qb(),m.yc(46,W,1,0,"tr",17),m.yc(47,Y,1,0,"tr",18),m.Sb(),m.Ob(48,"mat-paginator",19),m.Sb(),m.Sb(),m.Sb()),2&t&&(m.Bb(6),m.Bc("Detalle Compra: ",e.id,""),m.Bb(7),m.Bc("fecha: ",e.compra.fecha,""),m.Bb(3),m.Bc("distribuidor: ",e.compra.distribuidor,""),m.Bb(3),m.Bc("rut trabajador: ",e.compra.rut_empleado,""),m.Bb(3),m.Bc("TOTAL DE LA COMPRA: ",e.compra.preciototal,""),m.Bb(2),m.lc("dataSource",e.dataSource),m.Bb(22),m.lc("matHeaderRowDef",e.displayedColumns),m.Bb(1),m.lc("matRowDefColumns",e.displayedColumns),m.Bb(1),m.lc("pageSizeOptions",m.nc(9,Z)))},directives:[f.a,h.e,h.d,r.f,S.a,g.a,h.a,h.b,T.a,y.j,y.c,y.e,y.b,y.g,y.i,n.a,y.d,y.a,y.f,y.h],pipes:[c.d],styles:["table[_ngcontent-%COMP%]{width:100%}.scrollable[_ngcontent-%COMP%]{overflow-x:scroll}.a-warning[_ngcontent-%COMP%]{color:red}"]}),t})();class et{constructor(t){this.staticProductService=t,this.products=[],this.productSubject=new b.a([])}connect(t){return this.productSubject.asObservable()}disconnect(t){this.productSubject.complete()}loadSales(){this.productSubject.next(this.staticProductService.getAll())}}var ot=o("0IaG"),ct=o("e5Xn"),it=o("IeDO"),at=o("Wp6s"),rt=o("kmnG"),nt=o("qFsG"),bt=o("d3UM"),lt=o("FKr1"),st=o("iadO");function ut(t,e){if(1&t&&(m.Tb(0,"mat-option",18),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.lc("value",t.idCategoria),m.Bb(1),m.Bc(" ",t.nombre," ")}}function dt(t,e){1&t&&(m.Tb(0,"mat-error"),m.zc(1,"Porfavor seleccione una categoria"),m.Sb())}let mt=(()=>{class t{constructor(t,e,o,c,i){this.formBuilder=t,this.categoriaService=e,this.productService=o,this.router=c,this.data=i,console.log(i),this.buildForm()}ngOnInit(){this.categoriaService.getAll().subscribe(t=>{this.categorias=t.categorias,console.log(t)},t=>{console.log(t)})}buildForm(){this.form=this.formBuilder.group({nombre:["",[i.p.required]],precio:["",[i.p.required]],codigodebarra:[this.data,[i.p.required]],stock:["",[i.p.required]],categoria:["",[i.p.required]],fechaVencimiento:["",[i.p.required]]})}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(i.c),m.Nb(ct.a),m.Nb(it.a),m.Nb(r.c),m.Nb(ot.a))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-dialog-agregar-producto"]],decls:44,vars:7,consts:[["mat-dialog-title",""],["fxLayout","column"],["id","formProduct","fxLayout","column",3,"formGroup"],["fxFlex","auto"],["matInput","","formControlName","nombre","type","text"],["matInput","","formControlName","precio","type","number","min","0"],["matInput","","formControlName","stock","type","number","min","0"],["matInput","","formControlName","codigodebarra","type","text"],["formControlName","categoria","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","formControlName","fechaVencimiento",3,"matDatepicker","click"],["matSuffix","",3,"for"],["touchUi",""],["picker",""],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],[3,"value"]],template:function(t,e){if(1&t){const t=m.Ub();m.Tb(0,"h2",0),m.zc(1,"Delete all elements?"),m.Sb(),m.Tb(2,"mat-dialog-content"),m.Tb(3,"mat-card",1),m.Tb(4,"mat-card-content"),m.Tb(5,"form",2),m.Tb(6,"mat-form-field",3),m.Tb(7,"mat-label"),m.zc(8,"NOMBRE:"),m.Sb(),m.Ob(9,"input",4),m.Sb(),m.Tb(10,"mat-form-field",3),m.Tb(11,"mat-label"),m.zc(12,"PRECIO:"),m.Sb(),m.Ob(13,"input",5),m.Sb(),m.Tb(14,"mat-form-field",3),m.Tb(15,"mat-label"),m.zc(16,"Stock"),m.Sb(),m.Ob(17,"input",6),m.Sb(),m.Tb(18,"mat-form-field",3),m.Tb(19,"mat-label"),m.zc(20,"CODIGO DE BARRA:"),m.Sb(),m.Ob(21,"input",7),m.Sb(),m.Tb(22,"mat-form-field"),m.Tb(23,"mat-label"),m.zc(24,"Categoria"),m.Sb(),m.Tb(25,"mat-select",8),m.Tb(26,"mat-option"),m.zc(27,"--"),m.Sb(),m.yc(28,ut,2,2,"mat-option",9),m.Sb(),m.yc(29,dt,2,0,"mat-error",10),m.Tb(30,"mat-hint"),m.zc(31),m.Sb(),m.Sb(),m.Tb(32,"mat-form-field"),m.Tb(33,"mat-label"),m.zc(34,"Ingrese la fecha de vencimiento"),m.Sb(),m.Tb(35,"input",11),m.bc("click",(function(){return m.rc(t),m.pc(38).open()})),m.Sb(),m.Ob(36,"mat-datepicker-toggle",12),m.Ob(37,"mat-datepicker",13,14),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(39,"mat-dialog-actions",15),m.Tb(40,"button",16),m.zc(41,"Cancel"),m.Sb(),m.Tb(42,"button",17),m.zc(43," Agregar "),m.Sb(),m.Sb()}if(2&t){const t=m.pc(38);m.Bb(5),m.lc("formGroup",e.form),m.Bb(23),m.lc("ngForOf",e.categorias),m.Bb(1),m.lc("ngIf",e.form.get("categoria").getError("required")),m.Bb(2),m.Ac(null==e.form.get("categoria").value?null:e.form.get("categoria").value.sound),m.Bb(4),m.lc("matDatepicker",t),m.Bb(1),m.lc("for",t),m.Bb(6),m.lc("mat-dialog-close",e.form.value)}},directives:[ot.g,ot.e,at.a,h.e,at.d,i.q,i.k,i.e,rt.c,h.b,rt.g,nt.b,i.b,i.j,i.d,i.m,bt.a,i.o,lt.k,c.k,c.l,rt.f,st.b,st.d,rt.h,st.a,ot.c,S.b,ot.d,rt.b],styles:[""]}),t})();var pt=o("AytR"),ft=o("tk/3"),ht=o("bNrf");const St=pt.a.serverUrl;let gt=(()=>{class t{constructor(t,e){this.http=t,this.tokenStorageService=e}add(t){return this.http.post(St+"/distribuidores/registrar",{productos:t,rut:this.tokenStorageService.getUser().rut,rut_empresa:this.tokenStorageService.getUser().rut_empresa})}edit(t){return!1}getAll(){return this.http.post(St+"/distribuidores/ver",{rut_empresa:this.tokenStorageService.getUser().rut_empresa})}get(t){return this.http.post(St+"/distribuidores/verdetalles",{idventa:t,rut_empresa:this.tokenStorageService.getUser().rut_empresa})}delete(t){return this.http.post(St+"/distribuidores/eliminar",{idventa:t,rut_empresa:this.tokenStorageService.getUser().rut_empresa})}}return t.\u0275fac=function(e){return new(e||t)(m.Xb(ft.b),m.Xb(ht.a))},t.\u0275prov=m.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Tt=o("RKtL");function yt(t,e){if(1&t&&(m.Tb(0,"mat-option",38),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.lc("value",t.idDistribuidor),m.Bb(1),m.Bc(" ",t.Nombre," ")}}function vt(t,e){1&t&&(m.Tb(0,"mat-error"),m.zc(1,"Porfavor escoge un distribuidor"),m.Sb())}function Ct(t,e){1&t&&(m.Tb(0,"th",39),m.zc(1,"id"),m.Sb())}function Bt(t,e){if(1&t&&(m.Tb(0,"td",40),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.idProducto)}}function zt(t,e){1&t&&(m.Tb(0,"th",39),m.zc(1,"Nombre"),m.Sb())}function wt(t,e){if(1&t&&(m.Tb(0,"td",40),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.nombre)}}function Ot(t,e){1&t&&(m.Tb(0,"th",39),m.zc(1,"Precio"),m.Sb())}function kt(t,e){if(1&t&&(m.Tb(0,"td",40),m.zc(1),m.gc(2,"currency"),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Bc(" ",m.ic(2,1,t.precio,"CLP","$")," ")}}function Pt(t,e){1&t&&(m.Tb(0,"th",39),m.zc(1,"Codigo de Barra"),m.Sb())}function xt(t,e){if(1&t&&(m.Tb(0,"td",40),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Bc(" ",t.codigodebarra," ")}}function Dt(t,e){1&t&&(m.Tb(0,"th",39),m.zc(1,"Cantidad"),m.Sb())}function Rt(t,e){if(1&t){const t=m.Ub();m.Tb(0,"td",40),m.Tb(1,"span",41,42),m.zc(3,"1"),m.Sb(),m.Tb(4,"button",43),m.bc("click",(function(){m.rc(t);const o=e.$implicit,c=m.pc(2);return m.fc().minusProduct(c,o.stock,o.precio)})),m.Tb(5,"mat-icon"),m.zc(6,"remove"),m.Sb(),m.Sb(),m.Tb(7,"button",44),m.bc("click",(function(){m.rc(t);const o=e.$implicit,c=m.pc(2);return m.fc().plusProduct(c,o.stock,o.precio)})),m.Tb(8,"mat-icon"),m.zc(9,"add"),m.Sb(),m.Sb(),m.Sb()}if(2&t){const t=e.$implicit;m.Bb(1),m.Cb("data.idProducto",t.idProducto)}}function Lt(t,e){1&t&&(m.Tb(0,"th",39),m.zc(1,"Categoria"),m.Sb())}function At(t,e){if(1&t&&(m.Tb(0,"td",40),m.zc(1),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.Ac(t.categoria)}}function Nt(t,e){1&t&&m.Ob(0,"th",39)}function $t(t,e){if(1&t&&(m.Tb(0,"td",45),m.Tb(1,"a",46),m.Tb(2,"mat-icon",47),m.zc(3,"edit"),m.Sb(),m.Sb(),m.Sb()),2&t){const t=e.$implicit;m.Bb(1),m.mc("routerLink","editar/",t.idProducto,"")}}function Ft(t,e){1&t&&m.Ob(0,"th",39)}function It(t,e){if(1&t){const t=m.Ub();m.Tb(0,"td",45),m.Tb(1,"a",48),m.bc("click",(function(o){m.rc(t);const c=e.$implicit;return m.fc().deleteProduct(o,c.idProducto)})),m.Tb(2,"mat-icon",47),m.zc(3,"backspace"),m.Sb(),m.Sb(),m.Sb()}}function Qt(t,e){1&t&&m.Ob(0,"tr",49)}function jt(t,e){1&t&&m.Ob(0,"tr",50)}const _t=function(){return[5,10,20]},qt=[{path:"",component:F},{path:"comprar",component:(()=>{class t{constructor(t,e,o,c,i,a,r,n){this.formBuilder=t,this.dialog=e,this.productoService=o,this.dealerService=c,this.staticProductService=i,this.purchaseService=a,this.elementRef=r,this.router=n,this.displayedColumns=["id","nombre","precio","codigoBarra","stock","categoria","delete"],this.productos=[],this.precioTotalVisible=0,this.precioTotal=0,this.buildForm()}ngOnInit(){this.dataSource=new et(this.staticProductService),this.dataSource.loadSales(),this.getAllDistribuidores()}ngOnDestroy(){this.staticProductService.cleanProducts()}comprar(t){if(this.getProductsToBuy(),!this.isBuyValid())return;let e=this.form.value;e.preciototal=this.precioTotal,this.purchaseService.add(e,this.productos).subscribe(t=>{t.resultado&&this.router.navigate(["/admin/compras"])},t=>{console.log(t)})}getProductsToBuy(){this.productos=[];let t=this.elementRef.nativeElement.getElementsByClassName("quantitys");for(let e=0;e<t.length;e++){const o=t[e];let c={idProducto:o.getAttribute("data.idproducto"),cantidad:+o.innerText};this.productos.push(c)}}searchByCode(t,e){t.preventDefault(),this.codigoBarra=e,this.productoService.getByCodigoBarra(this.codigoBarra).subscribe(t=>{t.producto&&this.addProduct(t.producto)},t=>{console.log(t)})}addProduct(t){this.staticProductService.verifyProductOnList(t)?(this.updateQuantitySpan(t.idProducto),this.updateValorTotal()):(this.staticProductService.add(t),this.dataSource.loadSales(),this.updateValorTotal())}openDialog(t){this.dialog.open(mt,{data:t}).afterClosed().subscribe(t=>{t&&(console.log(t),this.addProduct(t))})}updateQuantitySpan(t){let e=this.elementRef.nativeElement.getElementsByClassName("quantitys");for(let o=0;o<e.length;o++){const c=e[o];c.getAttribute("data.idproducto")===t&&(c.innerText=+c.innerText+1)}}updateValorTotal(){this.precioTotal=this.staticProductService.getValorTotal(),this.precioTotalVisible=this.precioTotal}plusProduct(t,e,o){let c=+t.innerText;this.staticProductService.plusValorTotal(o),this.updateValorTotal(),t.innerText=++c}minusProduct(t,e,o){let c=+t.innerText;this.staticProductService.minusValorTotal(o),this.updateValorTotal(),t.innerText=--c}deleteProduct(t,e){this.staticProductService.delete(e),this.dataSource.loadSales(),this.productos=this.productos.filter(t=>t.idProducto!=e)}isBuyValid(){return 0!==this.productos.length&&!this.productos.find(t=>t.cantidad<=0)&&!!this.form.valid}buildForm(){this.form=this.formBuilder.group({distribuidor:["",[i.p.required]],fechayhora:["",[i.p.required]]})}getAllDistribuidores(){this.dealerService.getAll().subscribe(t=>{this.distribuidores=t.distribuidores},t=>{console.log(t)})}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(i.c),m.Nb(ot.b),m.Nb(it.a),m.Nb(gt),m.Nb(Tt.a),m.Nb(p.a),m.Nb(m.l),m.Nb(r.c))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-buy"]],viewQuery:function(t,e){var o;1&t&&m.vc(n.a,!0),2&t&&m.oc(o=m.cc())&&(e.paginator=o.first)},decls:78,vars:15,consts:[["fxLayout","row","fxLayoutAlign","space-between center"],["fxLayout","row"],["routerLink","../","mat-icon-button","","color","primary"],["fxFlexAlign","center"],["id","searchForm",3,"submit"],["value","","placeholder","ingresa aqui el codigo de barra para agregar productos"],["iCodigoBarra",""],["type","submit","mat-raised-button","","color","primary"],["routerLink","../","mat-raised-button","","color","primary"],["fxLayout","column"],["fxLayout","column",2,"height","100%"],["id","formProduct","fxLayout","column",3,"formGroup","ngSubmit"],["matInput","","formControlName","fechayhora",3,"matDatepicker","click"],["matSuffix","",3,"for"],["touchUi",""],["picker",""],["formControlName","distribuidor","required",""],["selected",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["fxFlex","auto","color","primary","mat-raised-button","","form","formProduct","type","submit"],["fxLayout","column","ngClass.xs","scrollable",1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","id","fxFlex","auto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","precio"],["matColumnDef","codigoBarra"],["matColumnDef","stock"],["matColumnDef","categoria"],["matColumnDef","edit"],["mat-cell","","class","action-link",4,"matCellDef"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxFlexOffset","auto"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"value"],["mat-header-cell",""],["mat-cell",""],[1,"quantitys"],["quantity",""],["mat-icon-button","","aria-label","Example icon button with a vertical three dot icon","color","warn",3,"click"],["mat-icon-button","","aria-label","Example icon button with a vertical three dot icon","color","primary",3,"click"],["mat-cell","",1,"action-link"],[3,"routerLink"],["aria-hidden","false","aria-label","Example home icon"],["routerLink","./",1,"a-warning",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-toolbar",0),m.Tb(1,"div",1),m.Tb(2,"a",2),m.Tb(3,"mat-icon"),m.zc(4,"arrow_back"),m.Sb(),m.Sb(),m.Tb(5,"span",3),m.zc(6,"Comprar"),m.Sb(),m.Sb(),m.Tb(7,"div"),m.Tb(8,"form",4),m.bc("submit",(function(o){m.rc(t);const c=m.pc(10);return e.searchByCode(o,c.value)})),m.Ob(9,"input",5,6),m.Tb(11,"button",7),m.Tb(12,"mat-icon"),m.zc(13,"search"),m.Sb(),m.zc(14," Agregar "),m.Sb(),m.Sb(),m.Sb(),m.Tb(15,"div"),m.Tb(16,"button",8),m.Tb(17,"mat-icon"),m.zc(18,"person"),m.Sb(),m.zc(19," Ingresar Producto "),m.Sb(),m.Sb(),m.Sb(),m.Tb(20,"section",9),m.Tb(21,"div",10),m.Tb(22,"div"),m.Tb(23,"mat-card"),m.Tb(24,"mat-card-content"),m.Tb(25,"form",11),m.bc("ngSubmit",(function(t){return e.comprar(t)})),m.Tb(26,"mat-form-field"),m.Tb(27,"mat-label"),m.zc(28,"Ingrese la fecha de compra"),m.Sb(),m.Tb(29,"input",12),m.bc("click",(function(){return m.rc(t),m.pc(32).open()})),m.Sb(),m.Ob(30,"mat-datepicker-toggle",13),m.Ob(31,"mat-datepicker",14,15),m.Sb(),m.Tb(33,"mat-form-field"),m.Tb(34,"mat-label"),m.zc(35,"Distribuidor"),m.Sb(),m.Tb(36,"mat-select",16),m.Tb(37,"mat-option",17),m.zc(38,"--"),m.Sb(),m.yc(39,yt,2,2,"mat-option",18),m.Sb(),m.yc(40,vt,2,0,"mat-error",19),m.Sb(),m.Sb(),m.Tb(41,"div"),m.Tb(42,"h1"),m.zc(43),m.gc(44,"currency"),m.Sb(),m.Sb(),m.Sb(),m.Tb(45,"mat-card-actions",1),m.Tb(46,"button",20),m.zc(47," REGISTRAR COMPRA "),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(48,"div",21),m.Tb(49,"table",22),m.Rb(50,23),m.yc(51,Ct,2,0,"th",24),m.yc(52,Bt,2,1,"td",25),m.Qb(),m.Rb(53,26),m.yc(54,zt,2,0,"th",24),m.yc(55,wt,2,1,"td",25),m.Qb(),m.Rb(56,27),m.yc(57,Ot,2,0,"th",24),m.yc(58,kt,3,5,"td",25),m.Qb(),m.Rb(59,28),m.yc(60,Pt,2,0,"th",24),m.yc(61,xt,2,1,"td",25),m.Qb(),m.Rb(62,29),m.yc(63,Dt,2,0,"th",24),m.yc(64,Rt,10,1,"td",25),m.Qb(),m.Rb(65,30),m.yc(66,Lt,2,0,"th",24),m.yc(67,At,2,1,"td",25),m.Qb(),m.Rb(68,31),m.yc(69,Nt,1,0,"th",24),m.yc(70,$t,4,1,"td",32),m.Qb(),m.Rb(71,33),m.yc(72,Ft,1,0,"th",24),m.yc(73,It,4,0,"td",32),m.Qb(),m.yc(74,Qt,1,0,"tr",34),m.yc(75,jt,1,0,"tr",35),m.Sb(),m.Sb(),m.Tb(76,"div",36),m.Ob(77,"mat-paginator",37),m.Sb(),m.Sb(),m.Sb()}if(2&t){const t=m.pc(32);m.Bb(25),m.lc("formGroup",e.form),m.Bb(4),m.lc("matDatepicker",t),m.Bb(1),m.lc("for",t),m.Bb(9),m.lc("ngForOf",e.distribuidores),m.Bb(1),m.lc("ngIf",e.form.get("distribuidor").getError("required")),m.Bb(3),m.Bc("TOTAL: ",m.ic(44,10,e.precioTotalVisible,"CLP","$"),""),m.Bb(6),m.lc("dataSource",e.dataSource),m.Bb(25),m.lc("matHeaderRowDef",e.displayedColumns),m.Bb(1),m.lc("matRowDefColumns",e.displayedColumns),m.Bb(2),m.lc("pageSizeOptions",m.nc(14,_t))}},directives:[f.a,h.e,h.d,r.f,S.a,g.a,h.a,i.q,i.k,i.l,S.b,r.d,at.a,at.d,i.e,rt.c,rt.g,nt.b,i.b,st.b,i.j,i.d,st.d,rt.h,st.a,bt.a,i.o,lt.k,c.k,c.l,at.b,h.b,T.a,y.j,y.c,y.e,y.b,y.g,y.i,h.c,n.a,rt.b,y.d,y.a,y.f,y.h],pipes:[c.d],styles:["mat-toolbar[_ngcontent-%COMP%]{height:7%}section[_ngcontent-%COMP%]{height:93%}table[_ngcontent-%COMP%]{width:100%}.scrollable[_ngcontent-%COMP%]{overflow-x:scroll}.a-warning[_ngcontent-%COMP%]{color:red}mat-paginator[_ngcontent-%COMP%]{font-weight:500;color:#000}"]}),t})()},{path:"detalle/:id",component:tt}];let Mt=(()=>{class t{}return t.\u0275mod=m.Lb({type:t}),t.\u0275inj=m.Kb({factory:function(e){return new(e||t)},imports:[[r.g.forChild(qt)],r.g]}),t})(),Vt=(()=>{class t{}return t.\u0275mod=m.Lb({type:t}),t.\u0275inj=m.Kb({factory:function(e){return new(e||t)},imports:[[c.c,Mt,a.a,i.n,i.f]]}),t})()}}]);